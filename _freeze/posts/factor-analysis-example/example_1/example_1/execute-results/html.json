{
  "hash": "5c0727c18246bd62cc418027b407e5c7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Example 1 | SEM [draft]\nauthor: Duc Nguyen\ndate: last-modified\nformat:\n  html:\n    toc: true\n    toc-title: \"Mục lục\"\n    toc-expand: 8\n    toc-depth: 6\n    toc-location: left\n    code-fold: false\n    code-summary: \"Show the code\"\n    number-sections: true\n    number-depth: 8\n    page-layout: full\n    embed-resources: false\n    anchor-sections: true\n    smooth-scroll: true\nengine: knitr\nknitr:\n  opts_chunk:\n    R.options:\n      width: 120\neditor_options: \n  chunk_output_type: console\nlightbox: true\ncategories: [SEM, example]\n\n---\n\n::: {.cell}\n\n:::\n\n\nNội dung này được tham khảo ở phần [2.6 Model Fitting Using `lavaan`](https://jslefche.github.io/sem_book/global-estimation.html#model-fitting-using-lavaan)\n\n# Import dataset\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lavaan)\nlibrary(piecewiseSEM)\n\ndata(keeley)\n\nhead(keeley)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  distance elev  abiotic age   hetero firesev     cover rich\n1 53.40900 1225 60.67103  40 0.757065    3.50 1.0387974   51\n2 37.03745   60 40.94291  25 0.491340    4.05 0.4775924   31\n3 53.69565  200 50.98805  15 0.844485    2.60 0.9489357   71\n4 53.69565  200 61.15633  15 0.690847    2.90 1.1949002   64\n5 51.95985  970 46.66807  23 0.545628    4.30 1.2981890   68\n6 51.95985  970 39.82357  24 0.652895    4.00 1.1734866   34\n```\n\n\n:::\n:::\n\n\nDữ liệu này gồm 90 observations of 8 variables. [Paper](http://book.thuviencanhan.com/ref/factor_analysis/keeley_2006.pdf)\n\nNghiên cứu này khảo sát mối quan hệ giữa `rich` (độ đa dạng thực vật) với các yếu tố khác như `distance` (khoảng cách từ khu rừng đến bờ biển), `elev` (độ cao so với mực nước biển), ... trong chủ đề kiểm soát cháy rừng ở California.\n\n`distance`: Distance to coast\n\n`elev`: Elevation from sea level\n\n`abiotic`: Abiotic favorability\n\n`age`: Age of stand before fire\n\n`hetero`: Plot heterogeneity\n\n`firesev`: Severity of fire\n\n`cover`: Cover of plants\n\n`rich`: Plant species richness\n\n# So sánh kết quả giữa chạy SEM bằng `lavaan` và linear regression\n\nĐầu tiên, ta khảo sát mối quan hệ giữa `age` độ tuổi của thực vật với `firesev` mức độ dễ cháy. Dễ nhìn ra, cây có độ tuổi càng cao thì thân và vỏ cây càng khô, dễ mục và từ đó dễ bắt lửa. Vì vậy biến `X = age`, biến `Y = firesev`.\n\nTa mô tả quan hệ giữa hai biến này như sau. Chiều mũi tên, cho thấy nguyên nhân `age` tác động đến kết quả `firesev` [biến nội sinh, endogenous (response) variable].\n\n![](global_estimation_keeley_sem1.png)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(firesev ~ age,\n     data = keeley,\n     las = 1,\n     main = \"Mối quan hệ giữa firesev và age\")\n\nfit <- lm(firesev ~ age, data = keeley)\n\nabline(fit, col = \"red\")\n```\n\n::: {.cell-output-display}\n![](example_1_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nvar(keeley$age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 157.9112\n```\n\n\n:::\n\n```{.r .cell-code}\nvar(keeley$firesev)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.73025\n```\n\n\n:::\n\n```{.r .cell-code}\ncov(keeley$age, keeley$firesev)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 9.423989\n```\n\n\n:::\n\n```{.r .cell-code}\ncor(keeley$age, keeley$firesev)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.4538654\n```\n\n\n:::\n:::\n\n\n\n## Phân tích theo kiểu SEM\n\nBản chất mối quan hệ này, ta có thể phân tích theo kiểu hồi quy tuyến tính để tìm ra tác động của biến `age` với biến `firesev`, và đó cũng là một mô hình SEM (về cơ bản SEM là mô hình hồi quy tuyến tính).\n\nThe package to fit the SEM using covariance-based methods is called `lavaan` (for LAtent VAriable ANalysis, which we will delve into in a later chapter).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkeeley_formula1 <- 'firesev ~ age'\n\nclass(keeley_formula1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"character\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nkeeley_sem1 <- sem(keeley_formula1, \n                   data = keeley)\n\nsummary(keeley_sem1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nlavaan 0.6-20 ended normally after 1 iteration\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                         2\n\n  Number of observations                            90\n\nModel Test User Model:\n                                                      \n  Test statistic                                 0.000\n  Degrees of freedom                                 0\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  firesev ~                                           \n    age               0.060    0.012    4.832    0.000\n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .firesev           2.144    0.320    6.708    0.000\n```\n\n\n:::\n:::\n\n\n\n\n<https://tuanvanle.wordpress.com/2011/09/12/c%C6%A1-s%E1%BB%9F-ly-thuy%E1%BA%BFt-c%E1%BB%A7a-mo-hinh-m%E1%BA%A1ng-sem-ph%E1%BA%A7n-1/>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "supporting": [
      "example_1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}